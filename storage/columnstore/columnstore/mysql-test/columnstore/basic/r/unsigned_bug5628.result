DROP DATABASE IF EXISTS unsigned_bug5628_db;
CREATE DATABASE unsigned_bug5628_db;
USE unsigned_bug5628_db;
CREATE TABLE bug5628 (c1 TINYINT UNSIGNED DEFAULT NULL ) ENGINE=Columnstore;
INSERT INTO bug5628 (c1) VALUE (127);
INSERT INTO bug5628 (c1) VALUE (128);
SELECT test, t1.c1 FROM ( SELECT 127 AS test FROM DUAL ) t INNER JOIN bug5628 t1 ON t.test=t1.c1 ORDER BY t1.c1;
test	c1
127	127
SELECT test, t1.c1 FROM ( SELECT 128 AS test FROM DUAL ) t INNER JOIN bug5628 t1 ON t.test=t1.c1 ORDER BY t1.c1;
test	c1
128	128
DROP TABLE IF EXISTS bug5628;
CREATE TABLE bug5628 (c1 SMALLINT UNSIGNED DEFAULT NULL ) ENGINE=Columnstore;
INSERT INTO bug5628 (c1) VALUE (32767);
INSERT INTO bug5628 (c1) VALUE (32768);
SELECT test, t1.c1 FROM ( SELECT 32767 AS test FROM DUAL ) t INNER JOIN bug5628 t1 ON t.test=t1.c1 ORDER BY t1.c1;
test	c1
32767	32767
SELECT test, t1.c1 FROM ( SELECT 32768 AS test FROM DUAL ) t INNER JOIN bug5628 t1 ON t.test=t1.c1 ORDER BY t1.c1;
test	c1
32768	32768
DROP TABLE IF EXISTS bug5628;
CREATE TABLE bug5628 (c1 INT UNSIGNED DEFAULT NULL ) ENGINE=Columnstore;
INSERT INTO bug5628 (c1) VALUE (2147483647);
INSERT INTO bug5628 (c1) VALUE (2147483648);
SELECT test, t1.c1 FROM ( SELECT 2147483647 AS test FROM DUAL ) t INNER JOIN bug5628 t1 ON t.test=t1.c1 ORDER BY t1.c1;
test	c1
2147483647	2147483647
SELECT test, t1.c1 FROM ( SELECT 2147483648 AS test FROM DUAL ) t INNER JOIN bug5628 t1 ON t.test=t1.c1 ORDER BY t1.c1;
test	c1
2147483648	2147483648
DROP TABLE IF EXISTS bug5628;
CREATE TABLE bug5628 (c1 BIGINT UNSIGNED DEFAULT NULL ) ENGINE=Columnstore;
INSERT INTO bug5628 (c1) VALUE (9223372036854775807);
INSERT INTO bug5628 (c1) VALUE (9223372036854775808);
SELECT test, t1.c1 FROM ( SELECT 9223372036854775807 AS test FROM DUAL ) t INNER JOIN bug5628 t1 ON t.test=t1.c1 ORDER BY t1.c1;
test	c1
9223372036854775807	9223372036854775807
SELECT test, t1.c1 FROM ( SELECT 9223372036854775808 AS test FROM DUAL ) t INNER JOIN bug5628 t1 ON t.test=t1.c1 ORDER BY t1.c1;
test	c1
9223372036854775808	9223372036854775808
DROP TABLE IF EXISTS bug5628;
CREATE TABLE bug5628A (c1 TINYINT DEFAULT NULL, 
c2 SMALLINT DEFAULT NULL, 
c3 INT DEFAULT NULL, 
c4 BIGINT DEFAULT NULL
) ENGINE=Columnstore;
CREATE TABLE bug5628B (c1 TINYINT UNSIGNED DEFAULT NULL, 
c2 SMALLINT UNSIGNED DEFAULT NULL, 
c3 INT UNSIGNED DEFAULT NULL, 
c4 BIGINT UNSIGNED DEFAULT NULL
) ENGINE=Columnstore;
INSERT INTO bug5628A (c1, c2, c3, c4) VALUES (-126, -32766, -2147483646, -9223372036854775806);
INSERT INTO bug5628B (c1, c2, c3, c4) VALUES (130, 32770, 2147483650, 9223372036854775810);
INSERT INTO bug5628A (c1, c2, c3, c4) VALUES (127, 32766, 2147483646, 9223372036854775806);
INSERT INTO bug5628B (c1, c2, c3, c4) VALUES (127, 32766, 2147483646, 9223372036854775806);
INSERT INTO bug5628B (c1, c2, c3, c4) VALUES (125, 32765, 2147483645, 9223372036854775805);
SELECT t1.c1, t2.c1 FROM bug5628A AS t1 INNER JOIN bug5628B t2 ON t1.c1=t2.c1 ORDER BY t1.c1;
c1	c1
127	127
SELECT t1.c2, t2.c2 FROM bug5628A AS t1 INNER JOIN bug5628B t2 ON t1.c2=t2.c2 ORDER BY t1.c2;
c2	c2
32766	32766
SELECT t1.c3, t2.c3 FROM bug5628A AS t1 INNER JOIN bug5628B t2 ON t1.c3=t2.c3 ORDER BY t1.c3;
c3	c3
2147483646	2147483646
SELECT t1.c4, t2.c4 FROM bug5628A AS t1 INNER JOIN bug5628B t2 ON t1.c4=t2.c4 ORDER BY t1.c4;
c4	c4
9223372036854775806	9223372036854775806
SELECT t1.c1, t2.c1, t1.c4, t2.c4 FROM bug5628A AS t1 INNER JOIN bug5628B t2 ON t1.c1=t2.c1 AND t1.c4=t2.c4 ORDER BY t1.c1;
c1	c1	c4	c4
127	127	9223372036854775806	9223372036854775806
SELECT t1.c1, t2.c1 FROM bug5628A AS t1 LEFT JOIN bug5628B t2 ON t1.c1=t2.c1 ORDER BY t1.c1;
c1	c1
-126	NULL
127	127
SELECT t1.c2, t2.c2 FROM bug5628A AS t1 LEFT JOIN bug5628B t2 ON t1.c2=t2.c2 ORDER BY t1.c2;
c2	c2
-32766	NULL
32766	32766
SELECT t1.c3, t2.c3 FROM bug5628A AS t1 LEFT JOIN bug5628B t2 ON t1.c3=t2.c3 ORDER BY t1.c3;
c3	c3
-2147483646	NULL
2147483646	2147483646
SELECT t1.c4, t2.c4 FROM bug5628A AS t1 LEFT JOIN bug5628B t2 ON t1.c4=t2.c4 ORDER BY t1.c4;
c4	c4
-9223372036854775806	NULL
9223372036854775806	9223372036854775806
SELECT t1.c1, t2.c1, t1.c4, t2.c4 FROM bug5628A AS t1 LEFT JOIN bug5628B t2 ON t1.c1=t2.c1 AND t1.c4=t2.c4 ORDER BY t1.c1;
c1	c1	c4	c4
-126	NULL	-9223372036854775806	NULL
127	127	9223372036854775806	9223372036854775806
SELECT t1.c1, t2.c1 FROM bug5628A AS t1 RIGHT JOIN bug5628B t2 ON t1.c1=t2.c1 ORDER BY t2.c1;
c1	c1
NULL	125
127	127
NULL	130
SELECT t1.c2, t2.c2 FROM bug5628A AS t1 RIGHT JOIN bug5628B t2 ON t1.c2=t2.c2 ORDER BY t2.c2;
c2	c2
NULL	32765
32766	32766
NULL	32770
SELECT t1.c3, t2.c3 FROM bug5628A AS t1 RIGHT JOIN bug5628B t2 ON t1.c3=t2.c3 ORDER BY t2.c3;
c3	c3
NULL	2147483645
2147483646	2147483646
NULL	2147483650
SELECT t1.c4, t2.c4 FROM bug5628A AS t1 RIGHT JOIN bug5628B t2 ON t1.c4=t2.c4 ORDER BY t2.c4;
c4	c4
NULL	9223372036854775805
9223372036854775806	9223372036854775806
NULL	9223372036854775810
SELECT t1.c1, t2.c1, t1.c4, t2.c4 FROM bug5628A AS t1 RIGHT JOIN bug5628B t2 ON t1.c1=t2.c1 AND t1.c4=t2.c4 ORDER BY t2.c1;
c1	c1	c4	c4
NULL	125	NULL	9223372036854775805
127	127	9223372036854775806	9223372036854775806
NULL	130	NULL	9223372036854775810
DROP TABLE IF EXISTS bug5628A;
DROP TABLE IF EXISTS bug5628B;
DROP DATABASE unsigned_bug5628_db;
