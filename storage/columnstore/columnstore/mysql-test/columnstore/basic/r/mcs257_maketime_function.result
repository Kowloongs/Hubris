DROP DATABASE IF EXISTS mcs257_db;
CREATE DATABASE mcs257_db;
USE mcs257_db;
CREATE TABLE t1
(
t1_INT INT,
t1_DECIMAL DECIMAL(12,5),
t1_TEXT TEXT,
t1_DATE DATE,
t1_TIME TIME
)ENGINE=Columnstore;
INSERT INTO t1 VALUES(1, 14.5699, 'pqrstuvwxyz', '1997-12-12', '22:12:02');
INSERT INTO t1 VALUES(2, 31.99, 'abcdefghijklm', '2001-1-1', '23:59:59');
INSERT INTO t1 VALUES(3, 58.7651, repeat('q', 5), '09-12-11', '01:08:59');
SELECT MAKETIME(1,2,3) FROM t1 LIMIT 1;
MAKETIME(1,2,3)
01:02:03
SELECT MAKETIME(11,12,13.123) FROM t1 LIMIT 1;
MAKETIME(11,12,13.123)
11:12:13.123
SELECT MAKETIME(12,13,14) FROM t1 LIMIT 1;
MAKETIME(12,13,14)
12:13:14
SELECT MAKETIME(23,59,59.999) FROM t1 LIMIT 1;
MAKETIME(23,59,59.999)
23:59:59.999
SELECT MAKETIME(24,0,0) FROM t1 LIMIT 1;
MAKETIME(24,0,0)
24:00:00
SELECT MAKETIME(0,1,1) FROM t1 LIMIT 1;
MAKETIME(0,1,1)
00:01:01
SELECT MAKETIME(0,0,0) FROM t1 LIMIT 1;
MAKETIME(0,0,0)
00:00:00
SELECT t1_TEXT, MAKETIME(13, t1_TEXT, 57) FROM t1 ORDER BY 1;
t1_TEXT	MAKETIME(13, t1_TEXT, 57)
abcdefghijklm	13:00:57
pqrstuvwxyz	13:00:57
qqqqq	13:00:57
SELECT t1_TEXT, MAKETIME(t1_TEXT, 13, 57) FROM t1 ORDER BY 1;
t1_TEXT	MAKETIME(t1_TEXT, 13, 57)
abcdefghijklm	00:13:57
pqrstuvwxyz	00:13:57
qqqqq	00:13:57
SELECT t1_TEXT, MAKETIME(13, 57, t1_TEXT) FROM t1 ORDER BY 1;
t1_TEXT	MAKETIME(13, 57, t1_TEXT)
abcdefghijklm	13:57:00.000000
pqrstuvwxyz	13:57:00.000000
qqqqq	13:57:00.000000
SELECT t1_DECIMAL, MAKETIME(15, 43, t1_DECIMAL) FROM t1 ORDER BY 1;
t1_DECIMAL	MAKETIME(15, 43, t1_DECIMAL)
14.56990	15:43:15.00000
31.99000	15:43:32.00000
58.76510	15:43:59.00000
SELECT t1_DECIMAL, MAKETIME(t1_DECIMAL, 12, 12) FROM t1 ORDER BY 1;
t1_DECIMAL	MAKETIME(t1_DECIMAL, 12, 12)
14.56990	15:12:12
31.99000	32:12:12
58.76510	59:12:12
SELECT t1_DECIMAL, MAKETIME(15, t1_DECIMAL, 43) FROM t1 ORDER BY 1;
t1_DECIMAL	MAKETIME(15, t1_DECIMAL, 43)
14.56990	15:15:43
31.99000	15:32:43
58.76510	15:59:43
SELECT t1_DECIMAL, MAKETIME(15, 43, t1_INT) FROM t1 ORDER BY 1;
t1_DECIMAL	MAKETIME(15, 43, t1_INT)
14.56990	15:43:01
31.99000	15:43:02
58.76510	15:43:03
SELECT t1_DECIMAL, MAKETIME(t1_INT, 12, 12) FROM t1 ORDER BY 1;
t1_DECIMAL	MAKETIME(t1_INT, 12, 12)
14.56990	01:12:12
31.99000	02:12:12
58.76510	03:12:12
SELECT t1_DECIMAL, MAKETIME(15, t1_INT, 43) FROM t1 ORDER BY 1;
t1_DECIMAL	MAKETIME(15, t1_INT, 43)
14.56990	15:01:43
31.99000	15:02:43
58.76510	15:03:43
SELECT MAKETIME(1,2) FROM t1 LIMIT 1;
ERROR 42000: Incorrect parameter count in the call to native function 'MAKETIME'
DROP DATABASE mcs257_db;
