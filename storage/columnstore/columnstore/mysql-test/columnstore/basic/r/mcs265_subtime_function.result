DROP DATABASE IF EXISTS mcs265_db;
CREATE DATABASE mcs265_db;
USE mcs265_db;
CREATE TABLE t1(t1_d DATE, t1_t TIME, t1_dt DATETIME)ENGINE=Columnstore;
INSERT INTO t1 VALUES(NULL, NULL, NULL);
INSERT INTO t1 VALUES('2222-11-11', '12:12:12', '2020-11-11 12:12:12');
INSERT INTO t1 VALUES('2020-01-01', '11:11:11', '2020-12-31 12:34:56');
INSERT INTO t1 VALUES('2016-02-01', '11:11:11', '2017-02-01 12:12:12');
SELECT SUBTIME('1990-09-24 19:52:17', '1 03:33:33') FROM t1 LIMIT 1;
SUBTIME('1990-09-24 19:52:17', '1 03:33:33')
1990-09-23 16:18:44
SELECT SUBTIME('19:52:17', '03:33:33') FROM t1 LIMIT 1;
SUBTIME('19:52:17', '03:33:33')
16:18:44
SELECT t1_d, SUBTIME(t1_d, '1 00:11:11.7101') FROM t1 ORDER BY 1;
t1_d	SUBTIME(t1_d, '1 00:11:11.7101')
NULL	NULL
2016-02-01	2016-01-29 23:48:48.9928
2020-01-01	2019-12-30 23:48:48.9928
2222-11-11	2222-11-09 23:48:48.9928
SELECT t1_dt, SUBTIME(t1_dt, '1 11:11:11') FROM t1 ORDER BY 1;
t1_dt	SUBTIME(t1_dt, '1 11:11:11')
NULL	NULL
2017-02-01 12:12:12	2017-01-31 01:01:01
2020-11-11 12:12:12	2020-11-10 01:01:01
2020-12-31 12:34:56	2020-12-30 01:23:45
SELECT t1_t, SUBTIME(t1_t, '00:11:11.7101') FROM t1 ORDER BY 1;
t1_t	SUBTIME(t1_t, '00:11:11.7101')
NULL	NULL
11:11:11	10:59:59.9928
11:11:11	10:59:59.9928
12:12:12	12:01:00.9928
DROP DATABASE mcs265_db;
