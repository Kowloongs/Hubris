#
# SUBSTR() function
# Author: Bharath, bharath.bokka@mariadb.com
#
-- source ../include/have_columnstore.inc

--disable_warnings
DROP DATABASE IF EXISTS mcs273_db;
--enable_warnings

CREATE DATABASE mcs273_db;
USE mcs273_db;

CREATE TABLE t1
(
 t1_INT INT,
 t1_DECIMAL DECIMAL(12,5),
 t1_TEXT TEXT,
 t1_DATE DATE,
 t1_TIME TIME
 )ENGINE=Columnstore;
INSERT INTO t1 VALUES(103, 1234.5699, 'pqr stu vwx yz', '1997-12-12', '22:12:02');
INSERT INTO t1 VALUES(-7299, 111.99, 'abcde//fghijk//lm', '2001-1-1', '23:59:59');
INSERT INTO t1 VALUES(9913, 98765.4321, repeat('q00', 5), '09-12-11', '01:08:59');

SELECT SUBSTR('123456789', 5, 3) FROM t1 LIMIT 1;
SELECT SUBSTR('abcdefghij', 3, 5) FROM t1 LIMIT 1;
SELECT SUBSTR('pqr stu vwz', 3, 5) FROM t1 LIMIT 1;
SELECT SUBSTR('pqr stu vwz', 3) FROM t1 LIMIT 1;
SELECT SUBSTR('pqr stu vwz' FROM 3) FROM t1 LIMIT 1;
SELECT SUBSTR('11:12:13' FROM 4 FOR 2) FROM t1 LIMIT 1;
SELECT SUBSTR('11:12:13', 4, 2) FROM t1 LIMIT 1;

SELECT SUBSTR(t1_TEXT FROM 3) FROM t1 ORDER BY 1;
SELECT SUBSTR(t1_TEXT, 3) FROM t1 ORDER BY 1;
SELECT SUBSTR(t1_TEXT FROM 3 FOR 15) FROM t1 ORDER BY 1;
SELECT SUBSTR(t1_TEXT, 3, 15) FROM t1 ORDER BY 1;

SELECT SUBSTR(t1_DATE FROM 3) FROM t1 ORDER BY 1;
SELECT SUBSTR(t1_DATE, 3) FROM t1 ORDER BY 1;
SELECT SUBSTR(t1_DATE FROM 3 FOR 15) FROM t1 ORDER BY 1;
SELECT SUBSTR(t1_DATE, 3, 15) FROM t1 ORDER BY 1;

SELECT SUBSTR(t1_TIME FROM 3) FROM t1 ORDER BY 1;
SELECT SUBSTR(t1_TIME, 3) FROM t1 ORDER BY 1;
SELECT SUBSTR(t1_TIME FROM 3 FOR 15) FROM t1 ORDER BY 1;
SELECT SUBSTR(t1_TIME, 3, 15) FROM t1 ORDER BY 1;

# Clean UP
DROP DATABASE mcs273_db;
