--source ../include/have_columnstore.inc

--echo #
--echo # MCOL-4757 Empty set in SELECT * INFORMATION_SCHEMA.COLUMNSTORE_TABLES WHERE TABLE_NAME='t1'
--echo #

--disable_warnings
DROP DATABASE IF EXISTS mcs_mcol4757;
--enable_warnings
CREATE DATABASE mcs_db_mcol4757;
USE mcs_db_mcol4757;

CREATE TABLE mcs_tbl_mcol4757 (x DECIMAL(38)) ENGINE=ColumnStore;

#
# Testing COLUMNSTORE_TABLES
#

SELECT TABLE_SCHEMA, TABLE_NAME FROM INFORMATION_SCHEMA.COLUMNSTORE_TABLES
  WHERE TABLE_SCHEMA='mcs_db_mcol4757';
SELECT TABLE_SCHEMA, TABLE_NAME FROM INFORMATION_SCHEMA.COLUMNSTORE_TABLES
  WHERE TABLE_NAME='mcs_tbl_mcol4757';
SELECT TABLE_SCHEMA, TABLE_NAME FROM INFORMATION_SCHEMA.COLUMNSTORE_TABLES
  WHERE TABLE_SCHEMA='mcs_db_mcol4757' AND TABLE_NAME='mcs_tbl_mcol4757';

SET @s='mcs_db_mcol4757';
SET @t='mcs_tbl_mcol4757';
SELECT TABLE_SCHEMA, TABLE_NAME FROM INFORMATION_SCHEMA.COLUMNSTORE_TABLES WHERE TABLE_SCHEMA=@s;
SELECT TABLE_SCHEMA, TABLE_NAME FROM INFORMATION_SCHEMA.COLUMNSTORE_TABLES WHERE TABLE_NAME=@t;

--disable_result_log
SELECT TABLE_SCHEMA, TABLE_NAME FROM INFORMATION_SCHEMA.COLUMNSTORE_TABLES WHERE LENGTH(TABLE_SCHEMA);
--enable_result_log

#
# Testing COLUMNSTORE_COLUMNS
#

SELECT TABLE_SCHEMA, TABLE_NAME FROM INFORMATION_SCHEMA.COLUMNSTORE_COLUMNS
  WHERE TABLE_SCHEMA='mcs_db_mcol4757';
SELECT TABLE_SCHEMA, TABLE_NAME FROM INFORMATION_SCHEMA.COLUMNSTORE_COLUMNS
  WHERE TABLE_NAME='mcs_tbl_mcol4757';
SELECT TABLE_SCHEMA, TABLE_NAME FROM INFORMATION_SCHEMA.COLUMNSTORE_COLUMNS
  WHERE TABLE_SCHEMA='mcs_db_mcol4757' AND TABLE_NAME='mcs_tbl_mcol4757';

SET @s='mcs_db_mcol4757';
SET @t='mcs_tbl_mcol4757';
SELECT TABLE_SCHEMA, TABLE_NAME FROM INFORMATION_SCHEMA.COLUMNSTORE_COLUMNS WHERE TABLE_SCHEMA=@s;
SELECT TABLE_SCHEMA, TABLE_NAME FROM INFORMATION_SCHEMA.COLUMNSTORE_COLUMNS WHERE TABLE_NAME=@t;

--disable_result_log
SELECT TABLE_SCHEMA, TABLE_NAME FROM INFORMATION_SCHEMA.COLUMNSTORE_COLUMNS WHERE LENGTH(TABLE_SCHEMA);
--enable_result_log


DROP DATABASE mcs_db_mcol4757;
