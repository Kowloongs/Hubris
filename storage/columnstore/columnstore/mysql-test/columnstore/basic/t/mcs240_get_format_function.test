#
# Test GET_FORMAT() function
# Author: Bharath, bharath.bokka@mariadb.com
#
-- source ../include/have_columnstore.inc

--disable_warnings
DROP DATABASE IF EXISTS mcs240_db;
--enable_warnings

CREATE DATABASE mcs240_db;
USE mcs240_db;

CREATE TABLE t1 (a INT, b DATE)ENGINE=Columnstore;
INSERT INTO t1 VALUES (1, '2020-11-01'), (2, '1871-3-25'), (3, '1999-07-16');

SELECT a, GET_FORMAT(DATE, 'USA') FROM t1 ORDER BY 1;
SELECT a, GET_FORMAT(DATE, 'JIS') FROM t1 ORDER BY 1;
SELECT a, GET_FORMAT(DATE, 'ISO') FROM t1 ORDER BY 1;
SELECT a, GET_FORMAT(DATE, 'EUR') FROM t1 ORDER BY 1;
SELECT a, GET_FORMAT(DATE, 'INTERNAL') FROM t1 ORDER BY 1;
SELECT b, DATE_FORMAT(b, GET_FORMAT(DATE, 'USA')) FROM t1 ORDER BY 1;
SELECT b, DATE_FORMAT(b, GET_FORMAT(DATE, 'JIS')) FROM t1 ORDER BY 1;
SELECT b, DATE_FORMAT(b, GET_FORMAT(DATE, 'ISO')) FROM t1 ORDER BY 1;
SELECT b, DATE_FORMAT(b, GET_FORMAT(DATE, 'EUR')) FROM t1 ORDER BY 1;
SELECT b, DATE_FORMAT(b, GET_FORMAT(DATE, 'INTERNAL')) FROM t1 ORDER BY 1;

SELECT a, GET_FORMAT(DATETIME, 'USA') FROM t1 ORDER BY 1;
SELECT a, GET_FORMAT(DATETIME, 'JIS') FROM t1 ORDER BY 1;
SELECT a, GET_FORMAT(DATETIME, 'ISO') FROM t1 ORDER BY 1;
SELECT a, GET_FORMAT(DATETIME, 'EUR') FROM t1 ORDER BY 1;
SELECT a, GET_FORMAT(DATETIME, 'INTERNAL') FROM t1 ORDER BY 1;
SELECT b, DATE_FORMAT(b, GET_FORMAT(DATETIME, 'USA')) FROM t1 ORDER BY 1;
SELECT b, DATE_FORMAT(b, GET_FORMAT(DATETIME, 'JIS')) FROM t1 ORDER BY 1;
SELECT b, DATE_FORMAT(b, GET_FORMAT(DATETIME, 'ISO')) FROM t1 ORDER BY 1;
SELECT b, DATE_FORMAT(b, GET_FORMAT(DATETIME, 'EUR')) FROM t1 ORDER BY 1;
SELECT b, DATE_FORMAT(b, GET_FORMAT(DATETIME, 'INTERNAL')) FROM t1 ORDER BY 1;

SELECT a, GET_FORMAT(TIME, 'USA') FROM t1 ORDER BY 1;
SELECT a, GET_FORMAT(TIME, 'JIS') FROM t1 ORDER BY 1;
SELECT a, GET_FORMAT(TIME, 'ISO') FROM t1 ORDER BY 1;
SELECT a, GET_FORMAT(TIME, 'EUR') FROM t1 ORDER BY 1;
SELECT a, GET_FORMAT(TIME, 'INTERNAL') FROM t1 ORDER BY 1;
SELECT b, DATE_FORMAT(b, GET_FORMAT(TIME, 'USA')) FROM t1 ORDER BY 1;
SELECT b, DATE_FORMAT(b, GET_FORMAT(TIME, 'JIS')) FROM t1 ORDER BY 1;
SELECT b, DATE_FORMAT(b, GET_FORMAT(TIME, 'ISO')) FROM t1 ORDER BY 1;
SELECT b, DATE_FORMAT(b, GET_FORMAT(TIME, 'EUR')) FROM t1 ORDER BY 1;
SELECT b, DATE_FORMAT(b, GET_FORMAT(TIME, 'INTERNAL')) FROM t1 ORDER BY 1;

# Clean UP
DROP DATABASE mcs240_db;
