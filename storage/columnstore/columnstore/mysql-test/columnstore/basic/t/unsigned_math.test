-- source ../include/have_columnstore.inc

--disable_warnings
DROP DATABASE IF EXISTS unsigned_math_db;
--enable_warnings

CREATE DATABASE unsigned_math_db;
USE unsigned_math_db;

create table j1 (j1_key int)engine=columnstore;
insert into j1 values (1),(2),(3),(4),(5),(6),(7),(8),(9),(10),(11),(12),(13),(14),(15),(null);

ALTER TABLE j1 ADD COLUMN CUTINYINT TINYINT UNSIGNED;
ALTER TABLE j1 ADD COLUMN CUSMALLINT SMALLINT UNSIGNED;
ALTER TABLE j1 ADD COLUMN CUINTEGER INT UNSIGNED;
ALTER TABLE j1 ADD COLUMN CUBIGINT BIGINT UNSIGNED;
UPDATE j1 SET CUTINYINT=253;
UPDATE j1 SET CUSMALLINT=65533;
UPDATE j1 SET CUINTEGER=4294967293;
UPDATE j1 SET CUBIGINT=18446744073709551613;

SELECT 'ABS1', ABS(CUTINYINT) FROM j1 WHERE j1_key=1;
SELECT 'ABS2', ABS(CUSMALLINT) FROM j1 WHERE j1_key=1;
SELECT 'ABS3', ABS(CUINTEGER) FROM j1 WHERE j1_key=1;
SELECT 'ABS4', ABS(CUBIGINT) FROM j1 WHERE j1_key=1;

SELECT 'CEIL1', CEIL(CUTINYINT) FROM j1 WHERE j1_key=1;
SELECT 'CEIL2', CEIL(CUSMALLINT) FROM j1 WHERE j1_key=1;
SELECT 'CEIL3', CEIL(CUINTEGER) FROM j1 WHERE j1_key=1;
SELECT 'CEIL4', CEIL(CUBIGINT) FROM j1 WHERE j1_key=1;

SELECT 'FLOOR1', FLOOR(CUTINYINT) FROM j1 WHERE j1_key=1;
SELECT 'FLOOR2', FLOOR(CUSMALLINT) FROM j1 WHERE j1_key=1;
SELECT 'FLOOR3', FLOOR(CUINTEGER) FROM j1 WHERE j1_key=1;
SELECT 'FLOOR4', FLOOR(CUBIGINT) FROM j1 WHERE j1_key=1;

SELECT 'DIV1', CUINTEGER DIV CUTINYINT FROM j1 WHERE j1_key=1;
SELECT 'DIV2', CUINTEGER DIV CUSMALLINT FROM j1 WHERE j1_key=1;
SELECT 'DIV3', CUBIGINT DIV CUTINYINT FROM j1 WHERE j1_key=1;
SELECT 'DIV4', CUBIGINT DIV CUSMALLINT FROM j1 WHERE j1_key=1;
SELECT 'DIV5', CUBIGINT DIV CUINTEGER FROM j1 WHERE j1_key=1;
SELECT 'DIV6', CUINTEGER DIV CUBIGINT FROM j1 WHERE j1_key=1;

SELECT 'EXP1', EXP(CUTINYINT) FROM j1 WHERE j1_key=1;

SELECT 'LN1', LN(CUTINYINT) FROM j1 WHERE j1_key=1;
SELECT 'LN2', LN(CUSMALLINT) FROM j1 WHERE j1_key=1;
SELECT 'LN3', LN(CUINTEGER) FROM j1 WHERE j1_key=1;
SELECT 'LN4', LN(CUBIGINT) FROM j1 WHERE j1_key=1;

SELECT 'LOG1', LOG(CUTINYINT) FROM j1 WHERE j1_key=1;
SELECT 'LOG2', LOG(CUSMALLINT) FROM j1 WHERE j1_key=1;
SELECT 'LOG3', LOG(CUINTEGER) FROM j1 WHERE j1_key=1;
SELECT 'LOG4', LOG(CUBIGINT) FROM j1 WHERE j1_key=1;

SELECT 'LOG21', LOG2(CUTINYINT) FROM j1 WHERE j1_key=1;
SELECT 'LOG22', LOG2(CUSMALLINT) FROM j1 WHERE j1_key=1;
SELECT 'LOG23', LOG2(CUINTEGER) FROM j1 WHERE j1_key=1;
SELECT 'LOG24', LOG2(CUBIGINT) FROM j1 WHERE j1_key=1;

SELECT 'LOG101', LOG10(CUTINYINT) FROM j1 WHERE j1_key=1;
SELECT 'LOG102', LOG10(CUSMALLINT) FROM j1 WHERE j1_key=1;
SELECT 'LOG103', LOG10(CUINTEGER) FROM j1 WHERE j1_key=1;
SELECT 'LOG104', LOG10(CUBIGINT) FROM j1 WHERE j1_key=1;

SELECT 'MD51', MD5(CUTINYINT) FROM j1 WHERE j1_key=1;
SELECT 'MD52', MD5(CUSMALLINT) FROM j1 WHERE j1_key=1;
SELECT 'MD53', MD5(CUINTEGER) FROM j1 WHERE j1_key=1;
SELECT 'MD54', MD5(CUBIGINT) FROM j1 WHERE j1_key=1;

SELECT 'MOD1', MOD(CUTINYINT,10) FROM j1 WHERE j1_key=1;
SELECT 'MOD2', MOD(CUSMALLINT,9) FROM j1 WHERE j1_key=1;
SELECT 'MOD3', MOD(CUINTEGER,8) FROM j1 WHERE j1_key=1;
SELECT 'MOD4', MOD(CUBIGINT,16) FROM j1 WHERE j1_key=1;

SELECT 'NULLIF1', NULLIF(CUTINYINT,253) FROM j1 WHERE j1_key=1;
SELECT 'NULLIF2', NULLIF(CUSMALLINT,65533) FROM j1 WHERE j1_key=1;
SELECT 'NULLIF3', NULLIF(CUINTEGER,4294967293) FROM j1 WHERE j1_key=1;
SELECT 'NULLIF4', NULLIF(CUBIGINT,18446744073709551613) FROM j1 WHERE j1_key=1;

SELECT 'NULLIF5', NULLIF(CUTINYINT,252) FROM j1 WHERE j1_key=1;
SELECT 'NULLIF6', NULLIF(CUSMALLINT,65532) FROM j1 WHERE j1_key=1;
SELECT 'NULLIF7', NULLIF(CUINTEGER,4294967292) FROM j1 WHERE j1_key=1;
SELECT 'NULLIF8', NULLIF(CUBIGINT,18446744073709551612) FROM j1 WHERE j1_key=1;

SELECT 'POW1', POW(CUTINYINT,4) FROM j1 WHERE j1_key=1;
SELECT 'POW2', POW(CUSMALLINT,4) FROM j1 WHERE j1_key=1;
SELECT 'POW3', POW(CUINTEGER,4) FROM j1 WHERE j1_key=1;
SELECT 'POW4', POW(CUBIGINT,4) FROM j1 WHERE j1_key=1;

SELECT 'ROUND1', ROUND(CUTINYINT) FROM j1 WHERE j1_key=1;
SELECT 'ROUND2', ROUND(CUSMALLINT) FROM j1 WHERE j1_key=1;
SELECT 'ROUND3', ROUND(CUINTEGER) FROM j1 WHERE j1_key=1;
SELECT 'ROUND4', ROUND(CUBIGINT) FROM j1 WHERE j1_key=1;

SELECT 'SIGN1', SIGN(CUTINYINT) FROM j1 WHERE j1_key=1;
SELECT 'SIGN2', SIGN(CUSMALLINT) FROM j1 WHERE j1_key=1;
SELECT 'SIGN3', SIGN(CUINTEGER) FROM j1 WHERE j1_key=1;
SELECT 'SIGN4', SIGN(CUBIGINT) FROM j1 WHERE j1_key=1;

SELECT 'SIN1', SIN(CUTINYINT) FROM j1 WHERE j1_key=1;
SELECT 'SIN2', SIN(CUSMALLINT) FROM j1 WHERE j1_key=1;
SELECT 'SIN3', SIN(CUINTEGER) FROM j1 WHERE j1_key=1;
SELECT 'SIN4', SIN(CUBIGINT) FROM j1 WHERE j1_key=1;

SELECT 'SQRT1', SQRT(CUTINYINT) FROM j1 WHERE j1_key=1;
SELECT 'SQRT2', SQRT(CUSMALLINT) FROM j1 WHERE j1_key=1;
SELECT 'SQRT3', SQRT(CUINTEGER) FROM j1 WHERE j1_key=1;
SELECT 'SQRT4', SQRT(CUBIGINT) FROM j1 WHERE j1_key=1;

SELECT 'TAN1', TAN(CUTINYINT) FROM j1 WHERE j1_key=1;
SELECT 'TAN2', TAN(CUSMALLINT) FROM j1 WHERE j1_key=1;
SELECT 'TAN3', TAN(CUINTEGER) FROM j1 WHERE j1_key=1;
SELECT 'TAN4', TAN(CUBIGINT) FROM j1 WHERE j1_key=1;

ALTER TABLE j1 DROP COLUMN CUTINYINT;
ALTER TABLE j1 DROP COLUMN CUSMALLINT;
ALTER TABLE j1 DROP COLUMN CUINTEGER;
ALTER TABLE j1 DROP COLUMN CUBIGINT;

# Clean UP
DROP DATABASE unsigned_math_db;
