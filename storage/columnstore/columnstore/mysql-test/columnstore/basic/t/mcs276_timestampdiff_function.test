#
# TIMESTAMPDIFF() function
# Author: Bharath, bharath.bokka@mariadb.com
#
-- source ../include/have_columnstore.inc

--disable_warnings
DROP DATABASE IF EXISTS mcs276_db;
--enable_warnings

CREATE DATABASE mcs276_db;
USE mcs276_db;

CREATE TABLE t1
(
 t1_DATE DATE,
 t1_TIMESTAMP TIMESTAMP,
 t1_DATETIME DATETIME
 )ENGINE=Columnstore;
INSERT INTO t1 VALUES('1991-05-30', '1999-10-28 01:00:50', '09-12-11 01:08:59');

SELECT TIMESTAMPDIFF(MICROSECOND, '2011-3-4 3:12:11.123', '2011-3-4 3:12:11.111') FROM t1 LIMIT 1;
SELECT TIMESTAMPDIFF(SECOND, '2012-3-3 1:12:22', '2013-3-4 3:12:18') FROM t1 LIMIT 1;
SELECT TIMESTAMPDIFF(MINUTE, '2012-3-3 1:12:22', '2013-3-4 3:12:18') FROM t1 LIMIT 1;
SELECT TIMESTAMPDIFF(HOUR, '2012-3-3 1:12:22', '2013-3-4 3:12:11') FROM t1 LIMIT 1;
SELECT TIMESTAMPDIFF(DAY, '2012-3-3 1:12:22', '2013-3-4 3:12:11') FROM t1 LIMIT 1;
SELECT TIMESTAMPDIFF(WEEK, '2012-3-3 1:12:22', '2013-3-4 3:12:11') FROM t1 LIMIT 1;
SELECT TIMESTAMPDIFF(MONTH, '2012-3-3 1:12:22', '2013-3-4 3:12:11') FROM t1 LIMIT 1;
SELECT TIMESTAMPDIFF(QUARTER, '2012-3-3 1:12:22', '2013-3-4 3:12:11') FROM t1 LIMIT 1;
SELECT TIMESTAMPDIFF(YEAR, '2012-3-3 1:12:22', '2013-3-4 3:12:11') FROM t1 LIMIT 1;

SELECT t1_DATE, TIMESTAMPDIFF(MICROSECOND, t1_DATE, '1991-05-30 00:00:00') FROM t1 ORDER BY 1;
SELECT t1_DATE, TIMESTAMPDIFF(SECOND, t1_DATE, '1991-05-30 00:00:55') FROM t1 ORDER BY 1;
SELECT t1_DATE, TIMESTAMPDIFF(MINUTE, t1_DATE, '1991-05-30 00:42:55') FROM t1 ORDER BY 1;
SELECT t1_DATE, TIMESTAMPDIFF(HOUR, t1_DATE, '1991-05-30 21:12:55') FROM t1 ORDER BY 1;
SELECT t1_DATE, TIMESTAMPDIFF(DAY, t1_DATE, '1991-05-31 1:12:55') FROM t1 ORDER BY 1;
SELECT t1_DATE, TIMESTAMPDIFF(WEEK, t1_DATE, '1991-06-30 1:12:55') FROM t1 ORDER BY 1;
SELECT t1_DATE, TIMESTAMPDIFF(MONTH, t1_DATE, '1991-06-30 1:12:55') FROM t1 ORDER BY 1;
SELECT t1_DATE, TIMESTAMPDIFF(QUARTER, t1_DATE, '1991-11-30 1:12:55') FROM t1 ORDER BY 1;
SELECT t1_DATE, TIMESTAMPDIFF(YEAR, t1_DATE, '1999-05-30 1:12:55') FROM t1 ORDER BY 1;

SELECT t1_TIMESTAMP, TIMESTAMPDIFF(MICROSECOND, t1_TIMESTAMP, '1999-10-28 01:00:51') FROM t1 ORDER BY 1;
SELECT t1_TIMESTAMP, TIMESTAMPDIFF(SECOND, t1_TIMESTAMP, '1999-10-28 00:00:55') FROM t1 ORDER BY 1;
SELECT t1_TIMESTAMP, TIMESTAMPDIFF(MINUTE, t1_TIMESTAMP, '1999-10-28 00:42:55') FROM t1 ORDER BY 1;
SELECT t1_TIMESTAMP, TIMESTAMPDIFF(HOUR, t1_TIMESTAMP, '1999-10-28 21:12:55') FROM t1 ORDER BY 1;
SELECT t1_TIMESTAMP, TIMESTAMPDIFF(DAY, t1_TIMESTAMP, '1999-12-30 1:12:55') FROM t1 ORDER BY 1;
SELECT t1_TIMESTAMP, TIMESTAMPDIFF(WEEK, t1_TIMESTAMP, '1999-06-30 1:12:55') FROM t1 ORDER BY 1;
SELECT t1_TIMESTAMP, TIMESTAMPDIFF(MONTH, t1_TIMESTAMP, '1991-06-30 1:12:55') FROM t1 ORDER BY 1;
SELECT t1_TIMESTAMP, TIMESTAMPDIFF(QUARTER, t1_TIMESTAMP, '1999-11-30 1:12:55') FROM t1 ORDER BY 1;
SELECT t1_TIMESTAMP, TIMESTAMPDIFF(YEAR, t1_TIMESTAMP, '2999-05-30 1:12:55') FROM t1 ORDER BY 1;

SELECT t1_DATETIME, TIMESTAMPDIFF(MICROSECOND, t1_DATETIME, '09-12-11 01:09:59') FROM t1 ORDER BY 1;
SELECT t1_DATETIME, TIMESTAMPDIFF(SECOND, t1_DATETIME, '09-12-11 01:09:59') FROM t1 ORDER BY 1;
SELECT t1_DATETIME, TIMESTAMPDIFF(MINUTE, t1_DATETIME, '09-12-11 01:09:59') FROM t1 ORDER BY 1;
SELECT t1_DATETIME, TIMESTAMPDIFF(HOUR, t1_DATETIME, '09-12-11 11:08:59') FROM t1 ORDER BY 1;
SELECT t1_DATETIME, TIMESTAMPDIFF(DAY, t1_DATETIME, '09-12-1 01:08:59') FROM t1 ORDER BY 1;
SELECT t1_DATETIME, TIMESTAMPDIFF(WEEK, t1_DATETIME, '09-11-11 01:08:59') FROM t1 ORDER BY 1;
SELECT t1_DATETIME, TIMESTAMPDIFF(MONTH, t1_DATETIME, '09-02-11 01:08:59') FROM t1 ORDER BY 1;
SELECT t1_DATETIME, TIMESTAMPDIFF(QUARTER, t1_DATETIME, '2009-02-11 01:08:59') FROM t1 ORDER BY 1;
SELECT t1_DATETIME, TIMESTAMPDIFF(YEAR, t1_DATETIME, '19-12-11 01:08:59') FROM t1 ORDER BY 1;

# Clean UP
DROP DATABASE mcs276_db;
