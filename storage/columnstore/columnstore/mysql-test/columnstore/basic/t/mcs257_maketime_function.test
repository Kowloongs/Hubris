#
# MAKETIME() function
# Author: Bharath, bharath.bokka@mariadb.com
#
-- source ../include/have_columnstore.inc

--disable_warnings
DROP DATABASE IF EXISTS mcs257_db;
--enable_warnings

CREATE DATABASE mcs257_db;
USE mcs257_db;

CREATE TABLE t1
(
 t1_INT INT,
 t1_DECIMAL DECIMAL(12,5),
 t1_TEXT TEXT,
 t1_DATE DATE,
 t1_TIME TIME
 )ENGINE=Columnstore;
INSERT INTO t1 VALUES(1, 14.5699, 'pqrstuvwxyz', '1997-12-12', '22:12:02');
INSERT INTO t1 VALUES(2, 31.99, 'abcdefghijklm', '2001-1-1', '23:59:59');
INSERT INTO t1 VALUES(3, 58.7651, repeat('q', 5), '09-12-11', '01:08:59');

SELECT MAKETIME(1,2,3) FROM t1 LIMIT 1;
SELECT MAKETIME(11,12,13.123) FROM t1 LIMIT 1;
SELECT MAKETIME(12,13,14) FROM t1 LIMIT 1;
SELECT MAKETIME(23,59,59.999) FROM t1 LIMIT 1;
SELECT MAKETIME(24,0,0) FROM t1 LIMIT 1;
SELECT MAKETIME(0,1,1) FROM t1 LIMIT 1;
SELECT MAKETIME(0,0,0) FROM t1 LIMIT 1;

SELECT t1_TEXT, MAKETIME(13, t1_TEXT, 57) FROM t1 ORDER BY 1;
SELECT t1_TEXT, MAKETIME(t1_TEXT, 13, 57) FROM t1 ORDER BY 1;
SELECT t1_TEXT, MAKETIME(13, 57, t1_TEXT) FROM t1 ORDER BY 1;

SELECT t1_DECIMAL, MAKETIME(15, 43, t1_DECIMAL) FROM t1 ORDER BY 1;
SELECT t1_DECIMAL, MAKETIME(t1_DECIMAL, 12, 12) FROM t1 ORDER BY 1;
SELECT t1_DECIMAL, MAKETIME(15, t1_DECIMAL, 43) FROM t1 ORDER BY 1;

SELECT t1_DECIMAL, MAKETIME(15, 43, t1_INT) FROM t1 ORDER BY 1;
SELECT t1_DECIMAL, MAKETIME(t1_INT, 12, 12) FROM t1 ORDER BY 1;
SELECT t1_DECIMAL, MAKETIME(15, t1_INT, 43) FROM t1 ORDER BY 1;

--error ER_WRONG_PARAMCOUNT_TO_NATIVE_FCT
SELECT MAKETIME(1,2) FROM t1 LIMIT 1;

# Clean UP
DROP DATABASE mcs257_db;
