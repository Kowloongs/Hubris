#
# WEEK() function
# Author: Bharath, bharath.bokka@mariadb.com
#
-- source ../include/have_columnstore.inc

--disable_warnings
DROP DATABASE IF EXISTS mcs279_db;
--enable_warnings

CREATE DATABASE mcs279_db;
USE mcs279_db;

CREATE TABLE t1
(
 t1_DATE DATE,
 t1_TIMESTAMP TIMESTAMP,
 t1_DATETIME DATETIME
 )ENGINE=Columnstore;
INSERT INTO t1 VALUES('1987-01-01', '1997-11-21 01:00:50', '2087-12-21 01:08:59');
INSERT INTO t1 VALUES('2991-10-13', '1972-11-22 11:19:52', '2000-01-01 05:28:37');

SELECT WEEK('2020-10-12') FROM t1 LIMIT 1;
SELECT WEEK('2020-05-22') FROM t1 LIMIT 1;
SELECT WEEK('2020-02-13 12:13:14') FROM t1 LIMIT 1;
SELECT WEEK('12:13:14') FROM t1 LIMIT 1;

SELECT t1_DATE, WEEK(t1_DATE) FROM t1 ORDER BY 1;
SELECT t1_DATE, WEEK(t1_DATE, 0) FROM t1 ORDER BY 1;
SELECT t1_DATE, WEEK(t1_DATE, 1) FROM t1 ORDER BY 1;
SELECT t1_DATE, WEEK(t1_DATE, 2) FROM t1 ORDER BY 1;
SELECT t1_DATE, WEEK(t1_DATE, 3) FROM t1 ORDER BY 1;
SELECT t1_DATE, WEEK(t1_DATE, 4) FROM t1 ORDER BY 1;
SELECT t1_DATE, WEEK(t1_DATE, 5) FROM t1 ORDER BY 1;
SELECT t1_DATE, WEEK(t1_DATE, 6) FROM t1 ORDER BY 1;
SELECT t1_DATE, WEEK(t1_DATE, 7) FROM t1 ORDER BY 1;

SELECT t1_DATETIME, WEEK(t1_DATETIME) FROM t1 ORDER BY 1;
SELECT t1_DATETIME, WEEK(t1_DATETIME, 0) FROM t1 ORDER BY 1;
SELECT t1_DATETIME, WEEK(t1_DATETIME, 1) FROM t1 ORDER BY 1;
SELECT t1_DATETIME, WEEK(t1_DATETIME, 2) FROM t1 ORDER BY 1;
SELECT t1_DATETIME, WEEK(t1_DATETIME, 3) FROM t1 ORDER BY 1;
SELECT t1_DATETIME, WEEK(t1_DATETIME, 4) FROM t1 ORDER BY 1;
SELECT t1_DATETIME, WEEK(t1_DATETIME, 5) FROM t1 ORDER BY 1;
SELECT t1_DATETIME, WEEK(t1_DATETIME, 6) FROM t1 ORDER BY 1;
SELECT t1_DATETIME, WEEK(t1_DATETIME, 7) FROM t1 ORDER BY 1;

SELECT t1_TIMESTAMP, WEEK(t1_TIMESTAMP) FROM t1 ORDER BY 1;
SELECT t1_TIMESTAMP, WEEK(t1_TIMESTAMP, 0) FROM t1 ORDER BY 1;
SELECT t1_TIMESTAMP, WEEK(t1_TIMESTAMP, 1) FROM t1 ORDER BY 1;
SELECT t1_TIMESTAMP, WEEK(t1_TIMESTAMP, 2) FROM t1 ORDER BY 1;
SELECT t1_TIMESTAMP, WEEK(t1_TIMESTAMP, 3) FROM t1 ORDER BY 1;
SELECT t1_TIMESTAMP, WEEK(t1_TIMESTAMP, 4) FROM t1 ORDER BY 1;
SELECT t1_TIMESTAMP, WEEK(t1_TIMESTAMP, 5) FROM t1 ORDER BY 1;
SELECT t1_TIMESTAMP, WEEK(t1_TIMESTAMP, 6) FROM t1 ORDER BY 1;
SELECT t1_TIMESTAMP, WEEK(t1_TIMESTAMP, 7) FROM t1 ORDER BY 1;

# Clean UP
DROP DATABASE mcs279_db;
