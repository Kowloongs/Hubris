--source ../include/have_columnstore.inc

--disable_warnings
DROP DATABASE IF EXISTS mcol_4728;
--enable_warnings

CREATE DATABASE mcol_4728;
USE mcol_4728;

SET columnstore_select_handler=ON;
CREATE TABLE t1 (a INT) ENGINE=ColumnStore;

SELECT SUM(0+0)-SUM(0+0) FROM t1;
SELECT SUM(0) FROM t1;
SELECT COUNT(0) FROM t1;
SELECT COUNT(NULL) FROM t1;
SELECT COUNT(COALESCE(NULL)) FROM t1;
SELECT MAX(0) FROM t1;
SELECT SUM(1)+1 FROM t1;
SELECT SUM(COALESCE(1))+1 FROM t1;
SELECT sum(rand(0))+1 FROM t1;

INSERT INTO t1 VALUES (100);

SELECT SUM(0+0)-SUM(0+0) FROM t1;
SELECT SUM(0) FROM t1;
SELECT COUNT(0) FROM t1;
SELECT COUNT(NULL) FROM t1;
SELECT COUNT(COALESCE(NULL)) FROM t1;
SELECT MAX(0) FROM t1;
SELECT SUM(1)+1 FROM t1;
SELECT SUM(COALESCE(1))+1 FROM t1;
SELECT sum(rand(0))+1 FROM t1;

DROP TABLE t1;

DROP DATABASE mcol_4728;
USE test;
